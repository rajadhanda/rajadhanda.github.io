<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raja Dhanda - Fixed Bubbles</title>

  <!-- Type -->
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" referrerpolicy="no-referrer" />

  <style>
    :root{
      --bg:#fefefe; --fg:#1a1a1a; --fg-light:#404040; --muted:#686868;
      --accent:#2a2a2a; --accent-soft:#f8f8f8;
      --border:#e8e8e8; --border-hover:#d4d4d4;
      --maxw:880px; --menu-w:420px;
      --ease:cubic-bezier(.16,1,.3,1);
      --ease-back:cubic-bezier(.34,1.56,.64,1);
      --shadow-soft:0 2px 20px rgba(0,0,0,.06);
      --shadow-medium:0 8px 30px rgba(0,0,0,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Crimson Text',serif; background:var(--bg); color:var(--fg);
      display:grid; grid-template-rows:1fr auto; align-items:center; justify-items:center;
      overflow-x:hidden; line-height:1.6;
    }

    /* Top-left menu */
    .menu-toggle{
      position:fixed; top:28px; left:28px; width:52px; height:52px; border-radius:50%;
      border:1px solid var(--border); display:grid; place-items:center;
      background:rgba(254,254,254,.92); backdrop-filter:blur(12px);
      cursor:pointer; transition:all .3s var(--ease); z-index:1001; box-shadow:var(--shadow-soft)
    }
    .menu-toggle:hover{transform:scale(1.05) translateY(-1px); border-color:var(--border-hover); box-shadow:var(--shadow-medium)}
    .menu-toggle i{font-size:18px; color:var(--fg); transition:transform .2s var(--ease)}
    .menu-toggle:hover i{transform:rotate(12deg)}

    /* Slide-out panel */
    .panel{
      position:fixed; inset:0 auto 0 0; width:min(100%,var(--menu-w)); max-width:92vw;
      background:var(--accent-soft); border-right:1px solid var(--border);
      transform:translateX(-100%); transition:transform .6s var(--ease); z-index:1000;
      display:flex; flex-direction:column; padding:32px 32px 36px; overflow-y:auto; backdrop-filter:blur(20px)
    }
    .panel.open{transform:translateX(0)}
    .panel header{
      font-family:'Inter',sans-serif; font-size:.85rem; color:var(--muted);
      letter-spacing:.08em; text-transform:uppercase; margin-bottom:24px; font-weight:500
    }
    nav ul{list-style:none; padding:0; margin:0 0 32px}
    nav li{margin:0; border-bottom:1px solid rgba(0,0,0,.04)}
    nav li:last-child{border-bottom:none}
    nav a{
      text-decoration:none; color:var(--fg); font-size:1.4rem; font-weight:400;
      transition:all .3s var(--ease); display:block; padding:14px 0; position:relative; overflow:hidden
    }
    nav a::before{
      content:''; position:absolute; bottom:0; left:-100%; width:100%; height:1px; background:var(--fg);
      transition:left .4s var(--ease)
    }
    nav a:hover::before{left:0}
    nav a:hover{color:var(--accent); transform:translateX(4px)}
    .about{margin-top:24px; border-top:1px solid var(--border); padding-top:24px; max-width:42ch; line-height:1.55; color:var(--fg-light); font-size:1.05rem}
    .about h3{margin:0 0 12px 0; font-size:1.2rem; color:var(--accent); font-family:'Inter',sans-serif; font-weight:500}

    /* Main */
    main{width:100%; max-width:var(--maxw); text-align:center; padding:40px 20px; align-self:center; justify-self:center; position:relative}
    .name{
      font-size:clamp(2.8rem,6vw,5.2rem); line-height:1.08; margin:0 0 16px 0; min-height:1.2em;
      letter-spacing:-.02em; font-weight:400; position:relative
    }
    .typing-cursor{display:inline-block; width:3px; height:1em; background:var(--fg); margin-left:4px; transform:translateY(.05em); animation:cursor-blink 1.4s ease-in-out infinite; border-radius:1px}
    @keyframes cursor-blink{0%,45%{opacity:1}50%,95%{opacity:.1}100%{opacity:1}}

    .subtitle{
      font-size:clamp(1.2rem,2.4vw,1.8rem); color:var(--muted); font-weight:400; font-style:italic;
      margin:20px 0 0 0; opacity:0; transform:translateY(12px);
      transition:opacity 1s var(--ease), transform 1s var(--ease); letter-spacing:.01em
    }
    .subtitle.show{opacity:1; transform:translateY(0)}

    /* Socials */
    .social-links{margin-top:8vh; display:flex; gap:32px; justify-content:center; align-items:center}
    .social-link{
      display:inline-flex; align-items:center; justify-content:center; text-decoration:none; color:var(--fg);
      font-size:24px; width:56px; height:56px; border:1px solid var(--border); border-radius:50%; background:var(--bg);
      transition:all .3s var(--ease-back); position:relative; overflow:hidden
    }
    .social-link::before{content:''; position:absolute; inset:0; background:var(--fg); border-radius:50%; transform:scale(0); transition:transform .3s var(--ease-back); z-index:-1}
    .social-link:hover::before{transform:scale(1)}
    .social-link:hover{color:var(--bg); transform:translateY(-3px); box-shadow:var(--shadow-medium); border-color:var(--fg)}

    /* Subtle ornaments */
    .floating-element{position:absolute; pointer-events:none; opacity:.15; color:var(--muted); font-size:12px; animation:float 8s ease-in-out infinite; z-index:-1}
    @keyframes float{0%,100%{transform:translateY(0) rotate(0)}33%{transform:translateY(-8px) rotate(2deg)}66%{transform:translateY(4px) rotate(-1deg)}}
    .floating-element:nth-child(1){top:15%; right:10%; animation-delay:-2s}
    .floating-element:nth-child(2){bottom:20%; left:8%; animation-delay:-5s; animation-duration:12s}

    /* Status chip */
    .status{
      position:fixed; bottom:28px; right:28px; font-family:'Inter',sans-serif; font-size:.8rem; color:var(--muted);
      display:flex; align-items:center; gap:8px; background:rgba(254,254,254,.9); backdrop-filter:blur(8px);
      padding:8px 16px; border-radius:20px; border:1px solid var(--border); opacity:0; animation:fadeInUp .8s ease-out 3s forwards
    }
    .status-dot{width:6px; height:6px; background:#22c55e; border-radius:50%; animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:1; transform:scale(1)}50%{opacity:.6; transform:scale(1.1)}}
    @keyframes fadeInUp{from{opacity:0; transform:translateY(10px)}to{opacity:1; transform:translateY(0)}}

    /* Backdrop */
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,0); backdrop-filter:blur(0); opacity:0; visibility:hidden; transition:all .4s var(--ease); z-index:999}
    .overlay.active{background:rgba(0,0,0,.1); backdrop-filter:blur(2px); opacity:1; visibility:visible}

    /* Bubble navigation (grid fallback) */
    .bubble-nav{
      margin-top:6vh; display:grid; grid-template-columns:repeat(2, minmax(160px,1fr));
      gap:clamp(16px,5vw,36px); align-items:center; justify-items:center;
    }
    @media (max-width:560px){
      .bubble-nav{grid-template-columns:1fr 1fr; gap:18px; margin-top:5vh}
    }

   .bubble{
  position:relative; width:clamp(160px,24vw,220px); aspect-ratio:1/1; border-radius:50%;
  border:1px solid rgba(0,0,0,.06); display:grid; place-items:center; text-decoration:none; color:var(--fg);
  overflow:hidden; background:rgba(250,250,250,.3); backdrop-filter:blur(8px);
  /* Do NOT transition transform; the physics loop owns it */
  transition: border-color .18s var(--ease), box-shadow .18s var(--ease), background .18s var(--ease);
  will-change: transform;
}
    .bubble:hover{
      border-color:var(--border-hover); box-shadow:0 12px 32px rgba(0,0,0,.12); 
      background:rgba(254,254,254,.85); backdrop-filter:blur(12px);
    }
    .bubble:focus-visible{
      outline:none; box-shadow:0 0 0 3px rgba(0,0,0,.08), 0 12px 32px rgba(0,0,0,.12); 
      border-color:var(--border-hover); background:rgba(254,254,254,.85);
    }

    .bubble-title{
      font-size:clamp(1.05rem,2.2vw,1.4rem); font-weight:400; line-height:1.2; text-align:center; 
      pointer-events:none; color:var(--muted); transition:color .4s var(--ease);
    }
    .bubble:hover .bubble-title{color:var(--fg)}
    .bubble-label{
      position:absolute; bottom:16px; left:50%; transform:translate(-50%,6px);
      font-style:italic; font-size:clamp(.82rem,1.6vw,.95rem); color:var(--muted);
      opacity:0; transition:opacity .2s var(--ease), transform .2s var(--ease);
      pointer-events:none; text-align:center; max-width:88%; line-height:1.25; white-space:normal; word-break:break-word
    }
    .bubble:hover .bubble-label,.bubble:focus-within .bubble-label{opacity:1; transform:translate(-50%,0)}

    /* Freeflow physics layer pinned to viewport */
    .bubble-nav.freeflow{
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 3;
  display: block;
  margin: 0; /* override base .bubble-nav margin-top */
}
    .bubble-nav.freeflow .bubble{
      position: absolute;
      pointer-events: auto;
    }

    /* Reduced motion: revert to grid */
    @media (prefers-reduced-motion: reduce){
      .bubble-nav.freeflow{position: static; width: auto; height: auto; display: grid; pointer-events: auto}
      .bubble-nav.freeflow .bubble{position: static}
    }

    /* Responsive tweaks */
    @media (max-width:768px){
      .menu-toggle{top:20px; left:20px; width:46px; height:46px}
      .panel{padding:24px}
      .about{max-width:100%}
      .social-links{margin-top:12vh; gap:24px}
      .status{bottom:20px; right:20px; font-size:.75rem}
      .floating-element{display:none}
    }
  </style>
</head>
<body>

  <!-- Ornaments -->
  <div class="floating-element">✦</div>
  <div class="floating-element">◇</div>

  <!-- Menu -->
  <button class="menu-toggle" aria-label="Open navigation" id="menuBtn">
    <i class="fa-solid fa-bars" aria-hidden="true"></i>
  </button>

  <div class="overlay" id="overlay"></div>

  <!-- Panel -->
  <aside class="panel" id="panel" aria-hidden="true">
    <header>Navigation</header>
    <nav aria-label="Primary">
      <ul>
        <li><a href="#" id="aboutLink">About</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/projects">Projects</a></li>
        <li><a href="/photographs">Photographs</a></li>
      </ul>
    </nav>

    <section class="about" id="aboutSection" aria-live="polite">
      <h3>About</h3>
      <p>I believe in the power of thoughtful design to create meaningful experiences. Currently exploring the intersections of technology, creativity, and human connection.</p>
      <p>Always learning, always making.</p>
    </section>
  </aside>

  <!-- Main -->
  <main>
    <h1 class="name" id="name" data-text="Raja Dhanda"></h1>
    <div class="subtitle" id="subtitle">experimenting with intention</div>

    <!-- Bubble navigation (freeflow enables physics) -->
    <nav id="bubbleNav" class="bubble-nav freeflow" aria-label="Primary">
      <a class="bubble" href="/about" data-key="about" aria-label="About">
        <span class="bubble-title">About</span>
        <em class="bubble-label">who I am in 2 mins</em>
      </a>
      <a class="bubble" href="/blog" data-key="blog" aria-label="Blog">
        <span class="bubble-title">Blog</span>
        <em class="bubble-label">notes and thought experiments</em>
      </a>
      <a class="bubble" href="/projects" data-key="projects" aria-label="Projects">
        <span class="bubble-title">Projects</span>
        <em class="bubble-label">things I've tried</em>
      </a>
      <a class="bubble" href="/photographs" data-key="photos" aria-label="Photographs">
        <span class="bubble-title">Photographs</span>
        <em class="bubble-label">frames I liked</em>
      </a>
    </nav>

    <div class="social-links" aria-label="Connect with me">
      <a class="social-link" href="https://www.linkedin.com/in/ramendra-raja-dhanda/" target="_blank" rel="noopener" aria-label="LinkedIn">
        <i class="fa-brands fa-linkedin" aria-hidden="true"></i>
      </a>
      <a class="social-link" href="mailto:hello@rajadhanda.me" target="_blank" rel="noopener" aria-label="Email">
        <i class="fa-solid fa-envelope" aria-hidden="true"></i>
      </a>
    </div>
  </main>

  <!-- Status -->
  <div class="status"><div class="status-dot"></div>Available for projects</div>

  <footer>© 2025 Raja Dhanda – Crafted with care</footer>

  <script>
    // ===== Simplified Bubble freeflow physics =====
    (function () {
      const nav = document.getElementById('bubbleNav');
      if (!nav) return;

      // Respect reduced motion: keep grid layout
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) { nav.classList.remove('freeflow'); return; }

      const bubbles = Array.from(nav.querySelectorAll('.bubble'));
      if (!bubbles.length) return;

      // Better center calculation that accounts for the full content area
      function getCenter() {
        const name = document.getElementById('name');
        const subtitle = document.getElementById('subtitle');
        const socialLinks = document.querySelector('.social-links');
        
        // Get viewport center as fallback
        let centerX = window.innerWidth / 2;
        let centerY = window.innerHeight / 2;
        
        // If elements exist, calculate proper center based on content
        if (name && name.getBoundingClientRect().height > 0) {
          const nameRect = name.getBoundingClientRect();
          const subtitleRect = subtitle ? subtitle.getBoundingClientRect() : nameRect;
          const socialRect = socialLinks ? socialLinks.getBoundingClientRect() : subtitleRect;
          
          // Center horizontally on viewport
          centerX = window.innerWidth / 2;
          
          // Center vertically between the name and social links
          const contentTop = nameRect.top;
          const contentBottom = socialRect.bottom;
          centerY = (contentTop + contentBottom) / 2;
        }
        
        // Calculate radius based on available space, ensuring bubbles don't go off-screen
        const availableWidth = window.innerWidth - 200; // margin for bubbles
        const availableHeight = window.innerHeight - 200; // margin for bubbles
        const radius = Math.min(200, Math.min(availableWidth, availableHeight) / 3);
        
        return { x: centerX, y: centerY, radius: Math.max(120, radius) };
      }

      // Initialize bubbles with evenly spaced positions around center
      const state = bubbles.map((el, i) => {
        // Evenly distribute bubbles around circle with slight randomness
        const baseAngle = (i / bubbles.length) * Math.PI * 2;
        const angleOffset = (Math.random() - 0.5) * 0.3; // Small random offset
        const radiusVariation = 0.9 + Math.random() * 0.2; // Slight radius variation
        
        return {
          el,
          angle: baseAngle + angleOffset,
          radiusMultiplier: radiusVariation,
          pos: { x: 0, y: 0 },
          vel: { x: 0, y: 0 },
          hovering: false,
          driftPhase: Math.random() * Math.PI * 2,
          targetPos: { x: 0, y: 0 }
        };
      });

      // Mouse tracking
      let pointer = { x: window.innerWidth / 2, y: window.innerHeight / 2, active: false };
      window.addEventListener('pointermove', (e) => {
        pointer = { x: e.clientX, y: e.clientY, active: true };
      }, { passive: true });

      // Hover handling
      state.forEach(s => {
        s.el.addEventListener('pointerenter', () => s.hovering = true);
        s.el.addEventListener('pointerleave', () => s.hovering = false);
      });

      let lastTime = performance.now();
      let running = true;
      let initialized = false;

      document.addEventListener('visibilitychange', () => {
        running = !document.hidden;
        if (running) {
          lastTime = performance.now();
          requestAnimationFrame(animate);
        }
      });

      function animate(time) {
        if (!running) return;
        
        const dt = Math.min(0.032, (time - lastTime) / 1000);
        lastTime = time;

        const center = getCenter();

        state.forEach(s => {
          // Calculate target position with drift
          const driftAmount = Math.sin(time * 0.0007 + s.driftPhase) * 10;
          const targetRadius = center.radius * s.radiusMultiplier + driftAmount;
          
          let targetX = center.x + Math.cos(s.angle) * targetRadius;
          let targetY = center.y + Math.sin(s.angle) * targetRadius;
// Gentle global spin so angles drift over time (radians/sec)
const spin = 0.08; // subtle
s.angle += spin * dt;
       // Magnetic effect on hover - gentle pull toward pointer
if (s.hovering && pointer.active) {
  const pullStrength = 0.16; // softer
  targetX += (pointer.x - targetX) * pullStrength;
  targetY += (pointer.y - targetY) * pullStrength;
}

          // Boundary enforcement with some margin, based on actual element size
const halfW = s.el.offsetWidth / 2;
const halfH = s.el.offsetHeight / 2;
const pad = 12;
const minX = halfW + pad, maxX = window.innerWidth  - halfW - pad;
const minY = halfH + pad, maxY = window.innerHeight - halfH - pad;
targetX = Math.max(minX, Math.min(maxX, targetX));
targetY = Math.max(minY, Math.min(maxY, targetY));

          s.targetPos = { x: targetX, y: targetY };

         // Spring physics (more damped, less overshoot)
const springStrength = initialized ? 0.06 : 0.18; // calm settle
const damping = 0.90; // stronger damping
          
s.vel.x += (s.targetPos.x - s.pos.x) * springStrength;
s.vel.y += (s.targetPos.y - s.pos.y) * springStrength;
s.vel.x *= damping;
s.vel.y *= damping;
          
          s.pos.x += s.vel.x;
          s.pos.y += s.vel.y;

          // Apply transform with hover scaling
          const scale = s.hovering ? 'scale(1.08)' : '';
          const bubbleSize = s.el.offsetWidth / 2;
          s.el.style.transform = `translate(${s.pos.x - bubbleSize}px, ${s.pos.y - bubbleSize}px) ${scale}`;
        });

        requestAnimationFrame(animate);
      }

      // Initialize positions immediately
      function init() {
        const center = getCenter();
        
        state.forEach(s => {
          const radius = center.radius * s.radiusMultiplier;
          s.pos.x = center.x + Math.cos(s.angle) * radius;
          s.pos.y = center.y + Math.sin(s.angle) * radius;
          
          const bubbleSize = s.el.offsetWidth / 2;
          s.el.style.transform = `translate(${s.pos.x - bubbleSize}px, ${s.pos.y - bubbleSize}px)`;
        });
        
        initialized = true;
        requestAnimationFrame(animate);
      }

      // Wait for layout to settle, then initialize
      function waitForLayout() {
        const name = document.getElementById('name');
        if (name && name.getBoundingClientRect().height > 0) {
          init();
        } else {
          setTimeout(waitForLayout, 50);
        }
      }

      // Start when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', waitForLayout);
      } else {
        waitForLayout();
      }

      // Recalculate on resize
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          initialized = false;
          setTimeout(() => {
            init();
          }, 100);
        }, 150);
      });
    })();

    // ===== Panel + typing =====
    const menuBtn = document.getElementById('menuBtn');
    const panel = document.getElementById('panel');
    const overlay = document.getElementById('overlay');
    const aboutLink = document.getElementById('aboutLink');

    function togglePanel(forceOpen) {
      const open = forceOpen !== undefined ? forceOpen : !panel.classList.contains('open');
      panel.classList.toggle('open', open);
      overlay.classList.toggle('active', open);
      panel.setAttribute('aria-hidden', (!open).toString());
      const icon = menuBtn.querySelector('i');
      icon.className = open ? 'fa-solid fa-xmark' : 'fa-solid fa-bars';
    }

    menuBtn.addEventListener('click', () => togglePanel());
    overlay.addEventListener('click', () => togglePanel(false));
    aboutLink?.addEventListener('click', (e) => { 
      e.preventDefault(); 
      togglePanel(true); 
      document.getElementById('aboutSection').scrollIntoView({behavior:'smooth',block:'start'}); 
    });
    window.addEventListener('keydown', (e) => { 
      if (e.key === 'Escape' && panel.classList.contains('open')) togglePanel(false); 
    });

    // Typing animation
    const nameEl = document.getElementById('name');
    const subtitleEl = document.getElementById('subtitle');
    const fullText = nameEl.dataset.text;
    const totalMs = 5000;
    const stepMs = Math.max(30, Math.floor(totalMs / Math.max(1, fullText.length)));
    let idx = 0;

    function typeNext() {
      if (idx <= fullText.length) {
        nameEl.innerHTML =
          '<span id="nameText">' + fullText.slice(0, idx) + '</span>' +
          '<span class="typing-cursor"></span>';
        idx++; 
        setTimeout(typeNext, stepMs + Math.random() * 40);
      } else {
        nameEl.innerHTML =
          '<span id="nameText">' + fullText + '</span>' +
          '<span class="typing-cursor"></span>';
        setTimeout(() => subtitleEl.classList.add('show'), 400);
      }
    }

    window.addEventListener('load', () => { 
      nameEl.textContent = ''; 
      setTimeout(typeNext, 500); 
    });

    // Parallax on ornaments
    let scrollPos = 0;
    window.addEventListener('scroll', () => {
      scrollPos = window.pageYOffset;
      document.querySelectorAll('.floating-element').forEach((el, i) => {
        const speed = (i + 1) * 0.5;
        el.style.transform = `translateY(${scrollPos * speed}px)`;
      });
    });
  </script>
</body>
</html>